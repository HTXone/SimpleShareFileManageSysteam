<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>历史记录 | 共享云端</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="img/factory1.ico">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/meanmenu.min.css">
    <link rel="stylesheet" href="css/educate-custon-icon.css">
    <!-- metisMenu CSS
    	============================================ -->
    <link rel="stylesheet" href="css/metisMenu/metisMenu.min.css">
    <link rel="stylesheet" href="css/metisMenu/metisMenu-vertical.css">
    <!-- style CSS
    	============================================ -->
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="css/toastr.css" />
	<style>
		table tr#th{
			background-color: #006df0;
			color: white;
		}
		
		.status1{
			background-color: orange;
			color: white;
			
			
		}
		
		.status2{
			
			background-color: green;
			color: white;
		}
		
		.status3{
			background-color: red;
			color: white;
			
		}
		
		.status4{
			background-color: deepskyblue;
			color: white;
		}
		
		.info{
			color: gray;
		}
		.data{
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }
		
		.selectBtn{
			margin-left: 20px;
			margin-top: 2px;
		}
		.selectBtn2{
			padding-left: 3px;
			padding-right: 3px;
			width: 150px;
		}
		.addBtn{
			margin-right: 20px;
			margin-top: 2px;
			float: right;
		}
	</style>
    
	
	</script>
	<style type="text/css">
		.a{
			margin-top: 70px;
		}
		.disabled {
		            pointer-events: none;
		            filter: alpha(opacity=50);
		            -moz-opacity: 0.5; 
		            opacity: 0.5; 
					}
	</style>
</head>

<body>
    <!--[if lt IE 8]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
	<![endif]-->
    <!-- Start Left menu area -->
    <div class="left-sidebar-pro">
        <nav id="sidebar" class="">
            <div class="sidebar-header">
                <a href="index_.html"><img class="main-logo" src="img/logo/LOGO1.png" alt="" /></a>
                <strong><a href="index_.html"><img src="img/logo/factory6.png" alt="" /></a></strong>
            </div>
            <div class="left-custom-menu-adp-wrap comment-scrollbar">
                <nav class="sidebar-nav left-sidebar-menu-pro">
                    <ul class="metismenu" id="menu1">
                        <li class="checked">
                            <a  href="index_.html"  >
                        		   <span class="educate-icon educate-home icon-wrap"></span>
                        		   <span class="mini-click-non">文件管理</span>
                        		</a>
                        </li>
                        </li>
                        <li>
                            <a href="History.html" aria-expanded="false"><span class="educate-icon educate-search icon-wrap"></span> <span class="mini-click-non">历史记录</span></a>
                            
                        </li>
                        <li>
                            <a href="users.html" aria-expanded="false"><span class="educate-icon educate-professor icon-wrap"></span> <span class="mini-click-non">用户管理</span></a>
                        
                        </li>
                        
                    </ul>
                </nav>
            </div>
        </nav>
    </div>
    <div class="all-content-wrapper">
        
        <div class="header-advance-area">
            <div class="header-top-area">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="header-top-wraper">
                                <div class="header-top-wraper">
                                    <div class="row">
                                        <div class="col-lg-1 col-md-0 col-sm-1 col-xs-12">
                                            <div class="menu-switcher-pro">
                                                <button type="button" id="sidebarCollapse" class="btn bar-button-pro header-drl-controller-btn btn-info navbar-btn">
                                						<i class="educate-icon educate-nav"></i>
                                					</button>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 col-md-7 col-sm-6 col-xs-12">
                                            <div class="header-top-menu tabl-d-n">
                                                
                                            </div>
                                        </div>
                                        <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                            <div class="header-right-info">
                                                <ul class="nav navbar-nav mai-top-nav header-right-menu">
                                                    
                                                    <li class="nav-item" id="uname">
                                                        <a :href="link" @click="isLogin" class="info"data-toggle="modal" data-target="#logout" >{{username}}</a>
                                                        
                                                    </li>
                                                    
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Mobile Menu start -->
            <div class="mobile-menu-area">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="mobile-menu">
                                <nav id="dropdown">
                                    <ul class="mobile-menu-nav">
                                        <li><a data-toggle="collapse" data-target="#Charts" href="index_.html">文件管理 <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                           
                                        </li>
                                        <li>
                                            <a  href="History.html" aria-expanded="false"><span class="educate-icon educate-settings icon-wrap"></span> <span class="mini-click-non">历史记录</span></a>
                                        </li>
                                        
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Mobile Menu end -->
            <div class="breadcome-area">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="analytics-sparkle-area a">
            <div class="analytics-sparkle-area a">
                <div class="container-fluid well">
                    <div class="form-group" id="selectList">
                    	<form class="form-inline" onsubmit="return false">
							<label form="name" style="margin-left: 20px; margin-right: 5px;">文件名称</label>
							<input class="form-control" type="text" v-model="FName" placeholder="" />
							<label form="name" style="margin-left: 20px; margin-right: 5px;">用户</label>
							<input class="form-control" type="text" v-model="UName" placeholder="" />	
							<button class="btn selectBtn" @click="doSelect">查询</button>
							<button class="btn selectBtn" @click="findAll">取消</button>
						</form>
                    </div>
                </div>
            </div>
        </div>
        <div class="product-sales-area mg-tb-30">
            <div id="tableapp1" class="data" style="width: 1200px;margin:0 auto;">
            	<table class="table table-striped table-hover">
            		<tr id="th">
					<th>序号</th>
					<th>记录序列号</th>
					<th>文件名</th>
            		<th>文件最后更新日期</th>
            		<th>更新状态</th>
					<th>更新用户</th>
            		</tr>
            		<tr v-for="(tr,index) in displayData">
            		<td>{{index+1}}</td>
					<td>{{tr.hid}}</td>
					<td>{{tr.fileName}}</td>
            		<td>{{tr.time}}</td>
            		<td :class="scolor[tr.estate]">{{sname[tr.mood]}}</td>
            		<td>{{tr.userName}}</td>
					</tr>
            		</table>
            </div>
          
        </div>
        </div>
<div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
				aria-hidden="true" data-keyboard="false"data-backdrop="false">
				            <div class="modal-dialog" id="updateList">
				                <div class="modal-content">
				                    <div class="modal-header b">
				                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
				                    &times;
				                </button>
				                        <h4 class="modal-title" id="myModalLabel">
				                    删除
				                </h4>
				                    </div>
				                    <div class="modal-body form-group">
										您确定要删除此记录吗?
				                    </div>
				                    <div class="modal-footer">
				                        <button type="button" class="btn btn-primary" onclick="vm.deletee(vm.Did)" data-dismiss="modal">
				                    确定
				                </button>
								<button type="button" class="btn btn-default"  data-dismiss="modal">
								    取消
								</button>
				                    </div>
				                </div>
				                <!-- /.modal-content -->
				            </div>
				            <!-- /.modal -->
				        </div>
	<div class="modal fade" id="logout" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
					aria-hidden="true" data-keyboard="false"data-backdrop="false">
					            <div class="modal-dialog" id="updateList">
					                <div class="modal-content">
					                    <div class="modal-header b">
					                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
					                    &times;
					                </button>
					                        <h4 class="modal-title" id="myModalLabel">
					                    登出
					                </h4>
					                    </div>
					                    <div class="modal-body form-group">
											您确定要退出登录?
					                    </div>
					                    <div class="modal-footer">
					                        <button type="button" class="btn btn-primary" onclick="vm.logout()" data-dismiss="modal">
					                    确定
					                </button>
									<button type="button" class="btn btn-default"  data-dismiss="modal">
									    取消
									</button>
					                    </div>
					                </div>
					                <!-- /.modal-content -->
					            </div>
					            <!-- /.modal -->
					        </div>
	<!--
    <!-- jquery
		============================================ -->
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <!-- bootstrap JS
		============================================ -->
    <script src="js/bootstrap.min.js"></script>
    <!-- wow JS
		============================================ -->
    <script src="js/wow.min.js"></script>
    <!-- price-slider JS
		============================================ -->
    <script src="js/jquery-price-slider.js"></script>
    <!-- meanmenu JS
		============================================ -->
    <script src="js/jquery.meanmenu.js"></script>
    <!-- owl.carousel JS
		============================================ -->
    <script src="js/owl.carousel.min.js"></script>
    <!-- sticky JS
		============================================ -->
    <script src="js/jquery.sticky.js"></script>
    <!-- scrollUp JS
		============================================ -->
    <script src="js/jquery.scrollUp.min.js"></script>
    <!-- counterup JS
		============================================ -->
    <script src="js/counterup/jquery.counterup.min.js"></script>
    <script src="js/counterup/waypoints.min.js"></script>
    <script src="js/counterup/counterup-active.js"></script>
    <!-- mCustomScrollbar JS
		============================================ -->
    <script src="js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="js/scrollbar/mCustomScrollbar-active.js"></script>
    <!-- metisMenu JS
		============================================ -->
    <script src="js/metisMenu/metisMenu.min.js"></script>
    <script src="js/metisMenu/metisMenu-active.js"></script>
    <!-- morrisjs JS
		============================================ -->
    
    <!-- morrisjs JS
		============================================ -->
    <script src="js/sparkline/jquery.sparkline.min.js"></script>
    <script src="js/sparkline/jquery.charts-sparkline.js"></script>
    <script src="js/sparkline/sparkline-active.js"></script>
    <!-- calendar JS
		============================================ -->
    <script src="js/calendar/moment.min.js"></script>
    <script src="js/calendar/fullcalendar.min.js"></script>
    <script src="js/calendar/fullcalendar-active.js"></script>
    <!-- plugins JS
		============================================ -->
    <script src="js/plugins.js"></script>
    <!-- main JS
		============================================ -->
    <script src="js/main.js"></script>
	<script src="js/toastr.min.js"></script>
	
	<script type="text/javascript">
				toastr.options.positionClass = 'toast-top';
	</script>

</body>

</html>
<script src="js/axios.min.js"></script>
<script src="js/vue.js"></script>

<script>
	var vm = new Vue({
	    el:"#tableapp1",
	    data:{
	        scolor:["","status1","status2","status3","status4"],
	        sname:["","新建","下载","删除","更新","加密","解密","压缩","解压"],
	        displayData:null,
			Did : "",
	    },
	   mounted(){
	       axios
	           .post("History/history.do")	
	           .then(response => (this.displayData = response.data.data))
	           .catch(function (error) {
	               console.log(error);
	           });
	   },
	   methods: {
	   	DeleteList : function(){
	   		axios.get('/equipment/delete.do?id='+this.Eid)
	   		.then(response => (vm.displayData = response.data.data))
	   		.catch(function(error){
	   			console.log(error)
	   		})
	   	},
	   	newProduct : function(){
	   		this.NewData.products.push({"pName":"",eff:0})
	   	},
	   	deleteProduct : function(index){
	   		this.NewData.products.splice(index,1);
	   	},
	   	getFile : function(event){
	   	    this.ImgFile = event.target.files[0];
	   		this.Img = "";
	   	    console.log(this.file)
	   	},
	   },
	})
	
	var selectVue = new Vue({
		el : '#selectList',
		data : {
			FName : "",
			UName : ""
		},
		methods:{
			doSelect : function(){
				axios.post('History/select.do?UName='+this.UName+'&FName='+this.FName)
				.then(response => (vm.displayData = response.data.data))
				.catch(function(error){
					console.log(error)
				})
			},
			getIndex : function(Index){
				updateVue.NewData = {"eid":"","estate":1,"products":[]};
			},
			findAll : function(){
				this.FName = "";
				this.UName = "";
				axios
				    .post("History/history.do")	
				    .then(response => (vm.displayData = response.data.data))
				    .catch(function (error) {
				        console.log(error);
				    });
			}
		}
	});
	
	var updateVue = new Vue({
		el : '#updateList',
		data : {
			PName : "",
			Eid : "",
			Fproducts : [],
			NewData : {"eid":"","estate":1,"products":[]},
			deleteId : "",
			ImgFile : null,
			Img : "",
			states : ["","停用","启用","故障","待机"],
			nowState : "",
			
		},
		mounted(){
		    axios
		        .post("History/history.do")	
		        .then(response => (this.Fproducts = response.data.data))
		        .catch(function (error) {
		            console.log(error);
		        });
		},
		methods: {
			doAdd : function(){
				if(this.ImgFile == null){
					let formdata = new FormData();
					formdata.append("data",JSON.stringify(this.NewData));
					const config = {
						headers : {
							"Content-Type":"multipart/form-data"
						}
					}
					axios.post('/equipment/add.do?',formdata,config)
					.then(response => (vm.displayData = response.data.data))
					.catch(function(error){
						console.log(error)
					})
				}
				else {
					let formdata = new FormData();
					formdata.append("data",JSON.stringify(this.NewData));
					formdata.append("picture",this.ImgFile);
					const config = {
						headers : {
							"Content-Type":"multipart/form-data"
						}
					}
					axios.post('/equipment/add.do?',formdata,config)
					.then(response => (vm.displayData = response.data.data))
					.catch(function(error){
						console.log(error)
					})
				}
			},
			DeleteList : function(){
				axios.get('/equipment/delete.do?id='+this.Eid)
				.then(response => (vm.displayData = response.data.data))
				.catch(function(error){
					console.log(error)
				})
			},
			newProduct : function(){
				this.NewData.products.push({"pName":"",eff:0})
			},
			deleteProduct : function(index){
				this.NewData.products.splice(index,1);
			},
			getFile : function(event){
			    this.ImgFile = event.target.files[0];
				this.Img = "";
			    console.log(this.file)
			},
		},
		
	})
	
	var uname = new Vue({
		el:"#uname",
		data:{
			username:"未登录，请先登录",
			link:"index_.html",
		},
		mounted(){
		    axios
		        .get("user/whoami.do")	
		        .then(response => {
					if(response.data.username=="未登录"){
						this.username="未登录，请先登录";
						this.link="index_.html";
					}else{
						this.username="欢迎，"+response.data.username;
						this.link="/";
					}
				
				})
		        .catch(function (error) {
		            console.log(error);
		        });
		},
		methods:{
			isLogin : function(){
				if(this.username == "未登录，请先登录"){
					window.location.href="."
				}
			}
		}
	})
	
	function PNameCmp(NewData){
		for(i=0;i<NewData.products.length;i++){
			for(j = i+1;j<NewData.products.length;j++){
				if(NewData.products[i].pName == NewData.products[j].pName){
					toastr.error("存在重复产能记录")
					return false;
				}
			}
		}
		return true;
	}
	
	

	var auth = new Vue({
		el:"#menu1",
		data:{
			fa:false,
			oa:false,
			pla:false,
			wa:false,
			ta:false
		},
		mounted() {
			console.log(document.cookie);
			this.fa=this.getCookie("fa");
			this.oa=this.getCookie("oa");
			this.pla=this.getCookie("pla");
			this.wa=this.getCookie("wa");
			this.ta=this.getCookie("ta");
		},
		methods:{
			getCookie(cname)
			{
			  var name = cname + "=";
			  var ca = document.cookie.split(';');
			  for(var i=0; i<ca.length; i++) 
			  {
			    var c = ca[i].trim();
			    if (c.indexOf(name)==0) return true;
			  }
			  return false;
			}
			
	
		}
	})

</script>